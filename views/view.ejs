<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= post.title %></title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <div
      class="blog-container"
      style="display: flex; max-width: 1200px; gap: 30px"
    >
      <!-- Main Content -->
      <div
        class="main-content"
        style="
          flex: 3;
          background: white;
          padding: 20px;
          border-radius: 15px;
          box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        "
      >
        <h1 style="font-size: 2.5rem; margin-bottom: 20px; color: #2c3e50">
          <%= post.title %>
        </h1>

        <% if (post.image) { %>
        <div>
          <img
            src="<%= post.image %>"
            alt="blog image"
            style="
              width: 100%;
              max-height: 400px;
              object-fit: cover;
              border-radius: 10px;
              box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            "
          />
        </div>
        <% } %>

        <!-- Blog Content -->
        <div
          class="blog-content"
          style="
            font-size: 1.15rem;
            line-height: 1.8;
            color: #2d3748;
            letter-spacing: 0.2px;
            white-space: pre-line; /* ‚úÖ preserves new lines & spaces */
          "
        >
          <p style="text-indent: 2em">
            <%= post.content.replace(/^\s*\n+/, '')%>
          </p>
        </div>

        <!-- AI Summary -->
        <% if (typeof summary !== 'undefined') { %>
        <div
          class="ai-summary"
          style="
            background: #e8f4fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
          "
        >
          <h4 style="color: #007bff; margin-bottom: 10px">
            AI-Generated Summary:
          </h4>
          <p style="margin: 0; color: #2d3748; font-style: italic">
            <%= summary %>
          </p>
        </div>
        <% } %>

        <p class="card-text text-muted fst-italic">
          <i>- By <%= post.author %></i>
        </p>
        <!-- Social Share Icons -->
        <div style="text-align: center; margin: 30px 0">
          <h3 style="color: #2c3e50; margin-bottom: 15px">Share this post</h3>
          <div style="display: flex; justify-content: center; gap: 15px">
            <a
              href="https://twitter.com/intent/tweet?text=<%= encodeURIComponent(post.title) %>&url=<%= encodeURIComponent('http://localhost:1080/posts/' + post._id + '/views') %>"
              target="_blank"
              style="
                color: #1da1f2;
                font-size: 1.5rem;
                text-decoration: none;
                padding: 10px;
                border-radius: 50%;
                background: rgba(29, 161, 242, 0.1);
                transition: background 0.3s;
              "
              >ùïè</a
            >
            <a
              href="https://www.facebook.com/sharer/sharer.php?u=<%= encodeURIComponent('http://localhost:1080/posts/' + post._id + '/views') %>"
              target="_blank"
              style="
                color: #1877f2;
                font-size: 1.5rem;
                text-decoration: none;
                padding: 10px;
                border-radius: 50%;
                background: rgba(24, 119, 242, 0.1);
                transition: background 0.3s;
              "
              >f</a
            >
            <a
              href="https://www.linkedin.com/sharing/share-offsite/?url=<%= encodeURIComponent('http://localhost:1080/posts/' + post._id + '/views') %>"
              target="_blank"
              style="
                color: #0077b5;
                font-size: 1.5rem;
                text-decoration: none;
                padding: 10px;
                border-radius: 50%;
                background: rgba(0, 119, 181, 0.1);
                transition: background 0.3s;
              "
              >in</a
            >
          </div>
        </div>

        <!-- Buttons -->
        <div
          class="card-actions"
          style="display: flex; justify-content: center; gap: 15px"
        >
          <form
            action="/posts/<%= post._id %>/edit"
            method="get"
            style="display: inline"
          >
            <button type="submit" class="card-btn edit">Edit</button>
          </form>
          <form
            action="/posts/<%= post._id %>?_method=DELETE"
            method="POST"
            style="display: inline"
          >
            <button type="submit" class="card-btn delete">Delete</button>
          </form>
        </div>
      </div>

      <!-- Sidebar -->
      <div
        class="sidebar"
        style="
          flex: 1;
          background: #f8f9fa;
          padding: 20px;
          border-radius: 15px;
          box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
          position: relative;
          overflow: hidden;
          color: #2c3e50;
        "
      >
        <!-- Background image -->
        <div
          style="
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: url('https://images.unsplash.com/photo-1493612276216-ee3925520721?q=80&w=764&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D')
              no-repeat center center/cover;
            opacity: 0.6;
            z-index: 0;
          "
        ></div>

        <!-- Content on top -->
        <div style="position: relative; z-index: 1">
          <h3 style="margin-bottom: 20px">Other Blog Posts</h3>
          <ul style="list-style: none; padding: 0">
            <% otherPosts.forEach(otherPost => { %>
            <li
              style="
                margin-bottom: 15px;
                border-bottom: 1px solid #ddd;
                padding-bottom: 10px;
                border-bottom: 2px solid grey;
              "
            >
              <a
                href="/posts/<%= otherPost._id %>/views"
                style="text-decoration: none; color: #2c3e50; font-weight: 500"
              >
                <%= otherPost.title %>
              </a>
              <p style="font-size: 0.9rem; color: #555; margin: 5px 0 0 0">
                By <%= otherPost.author %>
              </p>
            </li>
            <% }); %>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>
